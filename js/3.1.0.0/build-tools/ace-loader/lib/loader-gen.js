"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_loaderUtils=_interopRequireDefault(require("loader-utils")),_path=_interopRequireDefault(require("path")),_util=require("./util"),loaderPath=__dirname,defaultLoaders={none:"",main:_path.default.resolve(loaderPath,"loader.js"),template:_path.default.resolve(loaderPath,"template.js"),style:_path.default.resolve(loaderPath,"style.js"),script:_path.default.resolve(loaderPath,"script.js"),json:_path.default.resolve(loaderPath,"json.js"),babel:(0,_util.loadBabelModule)("babel-loader"),manifest:_path.default.resolve(loaderPath,"manifest-loader.js"),extgen:_path.default.resolve(loaderPath,"extgen.js")};function getLoaderString(e,t){var a=loadCustomLoader(t=t||{});switch(e){case"main":return mainLoaderString(void 0);case"element":return elementLoaderString(void 0,t);case"template":return templateLoaderString(void 0,t,a);case"style":return styleLoaderString(void 0,t,a);case"script":return scriptLoaderString(void 0,t,a);case"config":return configLoaderString(void 0,t);case"data":return dataLoaderString(void 0,t)}}function loadCustomLoader(e){if(e.lang&&e.customLang[e.lang])return(0,_util.loadBabelModule)(e.customLang[e.lang][0])}function mainLoaderString(e){return e=[{name:defaultLoaders.main}],(0,_util.stringifyLoaders)(e)}function elementLoaderString(e,t){return e=[{name:defaultLoaders.main,query:{element:!t.source||void 0}}],(0,_util.stringifyLoaders)(e)}function templateLoaderString(e,t,a){return e=[{name:defaultLoaders.json},{name:defaultLoaders.template}],a&&(e=e.concat(a)),e.push({name:defaultLoaders.extgen,query:{type:"template"}}),(0,_util.stringifyLoaders)(e)}function styleLoaderString(e,t,a){return e=[{name:defaultLoaders.json},{name:defaultLoaders.style}],a&&(e=e.concat(a)),e.push({name:defaultLoaders.extgen,query:{type:"style"}}),(0,_util.stringifyLoaders)(e)}function scriptLoaderString(e,t,a){return"card"===process.env.DEVICE_LEVEL?(e=[{name:defaultLoaders.json}],a&&(e=e.concat(a)),e.push({name:defaultLoaders.extgen,query:{type:"json"}})):(e=[{name:defaultLoaders.script}],a?e=e.concat(a):e.push({name:defaultLoaders.babel,query:{presets:[(0,_util.loadBabelModule)("@babel/preset-env")],plugins:[(0,_util.loadBabelModule)("@babel/plugin-transform-modules-commonjs")],comments:"false"}})),(0,_util.stringifyLoaders)(e)}function configLoaderString(e){return e=[{name:defaultLoaders.json}],(0,_util.stringifyLoaders)(e)}function dataLoaderString(e){return e=[{name:defaultLoaders.json}],(0,_util.stringifyLoaders)(e)}function codegenHmlAndCss(){var e=(_loaderUtils.default.getOptions(this)||{}).element,t=(this.resourceQuery&&_loaderUtils.default.parseQuery(this.resourceQuery)||{}).entry,a="",r=this.resourcePath.replace(process.env.aceSuperVisualPath,process.env.projectPath);if(r=r.substr(0,r.length-6)+"js","card"===process.env.DEVICE_LEVEL)a="//card_start\n",a+="var card_template ="+(0,_util.getRequireString)(this,(0,_util.jsonLoaders)("template",void 0,!0,"template"),this.resourcePath),a+="var card_style ="+(0,_util.getRequireString)(this,(0,_util.jsonLoaders)("style",void 0,!0,"style"),this.resourcePath),a+="var card_json ="+(0,_util.getRequireString)(this,(0,_util.jsonLoaders)("json",void 0,!0,"json"),this.resourcePath),a+="\n//card_end";else{a="var $app_script$ = "+generateOutput(this,"script",r,e),a+="var $app_template$ = "+generateOutput(this,"template",r,e),a+="var $app_style$ = "+generateOutput(this,"style",r,e),a+=generateOutput(this,"others",r,e),t&&(a+="$app_bootstrap$('@app-component/".concat((0,_util.getNameByPath)(this.resourcePath),"'")+",undefined,undefined)")}return a}function generateOutput(e,t,a,r,n){var o;switch(t){case"script":o=(0,_util.getRequireString)(e,getLoaderString("script",{customLang:n,lang:void 0,element:void 0,elementName:void 0,source:a}),a);break;case"template":o=(0,_util.getRequireString)(e,getLoaderString("template",{customLang:n,lang:void 0,element:r,elementName:void 0,source:e.resourcePath}),e.resourcePath);break;case"style":o=(0,_util.getRequireString)(e,getLoaderString("style",{customLang:n,lang:void 0,element:r,elementName:void 0,source:e.resourcePath}),e.resourcePath);break;case"others":o="\n      $app_define$('@app-component/".concat((0,_util.getNameByPath)(e.resourcePath),"', [],\n        function($app_require$, $app_exports$, $app_module$) {\n      ")+"\n      $app_script$($app_module$, $app_exports$, $app_require$)\n      if ($app_exports$.__esModule && $app_exports$.default) {\n      $app_module$.exports = $app_exports$.default\n      }\n      \n      $app_module$.exports.template = $app_template$\n      \n      $app_module$.exports.style = $app_style$\n      \n      })\n      "}return o}module.exports=codegenHmlAndCss;