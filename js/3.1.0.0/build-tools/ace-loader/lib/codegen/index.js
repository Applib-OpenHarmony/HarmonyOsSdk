(()=>{"use strict";var e={784:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.errorMap=void 0,t.errorMap=new Map([["fileError","Visual file is damaged"],["versionError","Version number of visual file does not match"],["modelError","Visual model in visual file is damaged"],["codegenError","Codegen hml and css failed"]])},117:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ASTNode=void 0;t.ASTNode=class{accept(e){return e.visit(this)}}},862:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Cache=void 0;t.Cache=class{constructor(e){this.value="",this.indent=0,this.flag=!0,this.INDENT=e}indentOn(){this.flag=!0}indentOff(){this.flag=!1}incIndent(){this.indent++}decIndent(){this.indent--}checkIndent(){return this.indent<0}getIndents(){if(this.flag){let e="";for(let t=0;t<this.indent;t++)e+=this.INDENT;return e}return""}concat(...e){return this.value+=this.getIndents(),this.value=this.value.concat(...e),String(this.value)}toString(){return this.value}}},243:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Style=t.Tag=void 0;const n=o(117);t.Tag=class extends n.ASTNode{constructor(e,t,o){super(),this.tagName=e,this.attributes=t,this.content=o}};t.Style=class extends n.ASTNode{constructor(e,t,o,n){super(),this.mediaQuery=void 0,this.kind=e,this.name=t,this.content=o,this.mediaQuery=n}}},573:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ASTNodeGenerator=void 0;const n=o(243),r=o(334);class s{constructor(e){this.cache=e}visit(e){e instanceof n.Tag?this.genTag(e):e instanceof n.Style&&this.genStyle(e)}static getMethodGen(e){return void 0===s.instance?s.instance=new s(e):s.instance.setCache(e),s.instance}setCache(e){this.cache=e}genTag(e){if(this.cache.concat(r.TokenClass.TAG_START,e.tagName),this.cache.indentOff(),e.attributes.forEach((e,t)=>{let o="";for(const t of e)o+='"'===t?"&quot;":"\n"===t?"&#10;":t;this.cache.concat(r.TokenClass.SPACE,t,r.TokenClass.ASSIGN,r.TokenClass.LQUOTE,o,r.TokenClass.RQUOTE)}),null===e.content)this.cache.concat(r.TokenClass.EMPTY_TAG_END);else{if(this.cache.concat(r.TokenClass.TAG_END),"string"==typeof e.content){let t="";for(const o of e.content)t+="<"===o?"&#60;":o;this.cache.concat(t)}else 0!==e.content.length&&(this.cache.concat(r.TokenClass.NEW_LINE),this.cache.indentOn(),this.cache.incIndent(),e.content.forEach(e=>{e.accept(this),this.cache.indentOff(),this.cache.concat(r.TokenClass.NEW_LINE),this.cache.indentOn()}),this.cache.decIndent(),this.cache.indentOn());this.cache.concat(r.TokenClass.END_TAG_START,e.tagName,r.TokenClass.TAG_END)}}genStyle(e){void 0!==e.mediaQuery&&(this.cache.concat("@media"),this.cache.indentOff(),this.cache.concat(r.TokenClass.SPACE,e.mediaQuery,r.TokenClass.SPACE,r.TokenClass.LBRA,r.TokenClass.NEW_LINE),this.cache.indentOn(),this.cache.incIndent()),"IDStyle"===e.kind&&(this.cache.concat(r.TokenClass.ID_STYLE_START),this.cache.indentOff()),this.cache.concat(e.name,r.TokenClass.SPACE,r.TokenClass.LBRA,r.TokenClass.NEW_LINE),this.cache.indentOn(),this.cache.incIndent(),e.content.forEach((e,t)=>{this.cache.concat(t,r.TokenClass.COLON,r.TokenClass.SPACE,e,r.TokenClass.SEMICOLON,r.TokenClass.NEW_LINE)}),this.cache.decIndent(),this.cache.concat(r.TokenClass.RBRA,r.TokenClass.NEW_LINE),void 0!==e.mediaQuery&&(this.cache.decIndent(),this.cache.concat(r.TokenClass.RBRA,r.TokenClass.NEW_LINE)),this.cache.concat(r.TokenClass.NEW_LINE)}}t.ASTNodeGenerator=s,s.instance=void 0},844:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CSSBridge=t.HMLBridge=void 0;const n=o(243),r=o(571);t.HMLBridge=class{constructor(){this.errors=0}error(e){console.error("Code generating error: "+e),this.errors+=1}getErrorCount(){return this.errors}visit(e){const t=new Map([["id",e.id]]);let o="";for(let[n,s]of e.property)r.isAttribute(n)?("string"!=typeof s&&(s=JSON.stringify(s)),t.set(n,s)):r.isContent(n)&&(o=s);if("list"===e.type&&t.set("itemscale","false"),e.children.length>0){o=[];for(const t of e.children)o.push(t.accept(this))}return new n.Tag(e.type,t,o)}};t.CSSBridge=class{constructor(){this.errors=0,this.styles=[]}error(e){console.error("Code generating error: "+e),this.errors+=1}getErrorCount(){return this.errors}genIDStyle(e){var t;const o=e=>{const t=new Map;for(const o of r.styleSet)e.has(o)&&r.isStyle(o)&&t.set(o,e.get(o));return t},s=o(e.property);s.size>0&&this.styles.push(new n.Style("IDStyle",e.id,s)),(null!==(t=e.mediaProperty)&&void 0!==t?t:new Map).forEach((t,r)=>{const s=o(t);s.size>0&&this.styles.push(new n.Style("IDStyle",e.id,s,r))});for(const t of e.children)t.accept(this)}visit(e){return this.genIDStyle(e),this.styles}}},55:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.genFACSS=t.genFAHML=void 0;const n=o(573),r=o(862);t.genFAHML=function(e){const t=n.ASTNodeGenerator.getMethodGen(new r.Cache("    "));return e.accept(t),t.cache.toString()},t.genFACSS=function(e){const t=n.ASTNodeGenerator.getMethodGen(new r.Cache("    "));return e.forEach(e=>{e.accept(t)}),t.cache.toString()}},571:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isEvent=t.isData=t.isUnknown=t.isContent=t.isAttribute=t.isStyle=t.styleSet=void 0;const o=["background-color",...["background","background-image","background-size","background-position","background-repeat"]],n=[...["width","height","min-width","min-height","max-width","max-height"],...["padding","padding-start","padding-end","padding-top","padding-right","padding-bottom","padding-left"],...["margin","margin-start","margin-end","margin-top","margin-right","margin-bottom","margin-left"],...["border-width","border-style","border-color","border-radius","border-top-width","border-top-style","border-top-color","border-top-left-radius","border-right-width","border-right-style","border-right-color","border-top-right-radius","border-bottom-width","border-bottom-style","border-bottom-color","border-bottom-right-radius","border-left-width","border-left-style","border-left-color","border-bottom-left-radius"],...o,...["display","opacity","visibility"],...["flex","flex-grow","flex-shrink","flex-basis"],...["position","display","top","right","bottom","left"],...["display-index","flex-weight","aspect-ratio"]],r=["font-size","font-family","font-style","font-weight"],s=["flex-direction",...["flex-wrap","justify-content","align-items","align-content"]],i=["text-align","line-height","text-decoration","letter-spacing","max-lines","text-overflow","allow-scale","min-font-size","max-font-size","font-size-step","prefer-font-sizes",...r],a=["allow-scale","text-decoration","color",...r],c=["text-color","allow-scale","icon-width","icon-height","radius",...r],l=["texton-color","textoff-color","text-padding","allow-scale",...r],d=["column-height","text-color","allow-scale","letter-spacing","text-decoration","line-height","opacity",...r];t.styleSet=new Set([...n,...s,...i,...["object-fit","match-text-direction","fit-original-size"],...a,...["font-size","font-family","font-weight","color","placeholder-color","allow-scale"],...c,...l,...["progress-color"],...["stroke-width","line-cap"],...["stroke-width","radius","start-angle","total-angle","center-x","center-y","colors","weights"],...d,...["color","selected-color","block-color"],...["indicator-color","indicator-selected-color","indicator-size","indicator-top","indicator-right","indicator-bottom","indicator-left"],...["flex-direction","columns","item-extent","fade-color"],...["column-span"],...["color","stroke-width","background-color","secondary-color","scale-width","scale-number","start-angle","total-angle","center-x","center-y","radius"],...["grid-template-columns","grid-template-rows","grid-row-start","grid-row-end","grid-column-start","grid-column-end","grid-gap","grid-columns-gap","grid-rows-gap"]]);const h=new Set([...["id","ref","disabled","focusable","data","if","for"],...["src","alt"],...["type","value","icon","waiting"],...["offset","refreshing","type","lasttime","friction"],...["type","checked","name","value","placeholder","maxlength","enterkeytype","headericon"],...["checked","showtext","texton","textoff"],...["value"],...["percent","datasets","options"],...["range","selected","start","end","lunar","lunarSwitch","columns","hours","containSecond"],...["min","max","step","showtips","showsteps","mode"],...["vertical"],...["scrollpage","cachedcount","scrollbar","scrolleffect","shapemode","indexer","itemscale","itemcenter","updateeffect","scrollvibrate","initialindex","initialoffset"],...["type","primary","section","sticky","stickyradius","clickeffect"],...["index","autoplay","interval","indicator","digital","indicatordisabled","loop","duration","vertical"],...["type","percent","secondarypercent","clockwise"],...["target","title"],...["clockconfig","showdigit","hourswest"]]),p=new Set([...["ontouchstart","ontouchmove","ontouchcancel","ontouchend","onclick","onlongpress","onfocus","onblur","onkey","onswipe"],...["oncomplete","onerror"],...["onchange","onenterkeyclick"],...["onchange"],...["onrefresh","onpulldown"],...["change","onrotation"],...["onindexerchange","onscroll","onscrollbottom","onscrolltop","onscrollend","onscrolltouchup","onrequestitem"],...["onsticky"],...["onselected","oncancel"],...["oncolumnchange"]]);function u(e){return t.styleSet.has(e)}function f(e){return h.has(e)||p.has(e)}t.isStyle=u,t.isAttribute=f,t.isContent=function(e){return"content"===e},t.isUnknown=function(e){return!u(e)&&!f(e)},t.isData=function(e){return h.has(e)},t.isEvent=function(e){return p.has(e)}},334:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TokenClass=void 0,function(e){e[e.IDENTIFIER=0]="IDENTIFIER",e[e.STRING_LITERAL=1]="STRING_LITERAL",e[e.NUMBER=2]="NUMBER",e[e.CHARACTER=3]="CHARACTER",e[e.EOF=4]="EOF",e[e.INVALID=5]="INVALID",e.EMPTY_DATA="empty",e.ASSIGN="=",e.NEW_LINE="\n",e.CARRIAGE_RETURN="\r",e.INDENT="    ",e.SPACE=" ",e.LQUOTE='"',e.RQUOTE='"',e.TAG_START="<",e.TAG_END=">",e.EMPTY_TAG_END="/>",e.END_TAG_START="</",e.ID_STYLE_START="#",e.CLASS_STYLE_START=".",e.LBRA="{",e.RBRA="}",e.SEMICOLON=";",e.COLON=":"}(t.TokenClass||(t.TokenClass={}))},282:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TagTypeMap=void 0;t.TagTypeMap=new Map([["button","TextContent"],["span","TextContent"],["divider","TextContent"],["picker","TextContent"],["option","TextContent"],["clock","TextContent"],["image","Base"],["input","Base"],["chart","Base"],["slider","Base"],["progress","Base"],["text","Text"],["div","Container"],["list","Container"],["list-item","Container"],["list-item-group","Container"],["refresh","Container"],["dialog","Container"],["stack","Container"],["menu","Container"]])},207:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formManager=void 0;const n=o(891),r=o(945);t.formManager={removeData(e){this.getFormModel().data.delete(e)},addData(e){e instanceof Map?e.forEach((e,t)=>{this.getFormModel().data.set(t,e)}):Object.keys(e).forEach(t=>{this.getFormModel().data.set(t,e[t])})},updateAllData(e){this.getFormModel().data.clear(),this.addData(e)},addAction(e,t,o,n){const s=new Map;null!=o&&Object.keys(o).forEach(e=>{s.set(e,o[e])});const i=new Map;null!=n&&Object.keys(n).forEach(e=>{i.set(e,n[e])}),this.getFormModel().actions.set(e,new r.FormAction(t,s,i))},updateAllActions(e){this.getFormModel().actions.clear(),e.forEach((e,t)=>{const o=this.objectToMap(e.params),n=new r.FormAction(e.actionType,o);this.getFormModel().actions.set(t,n)})},removeAction(e){this.getFormModel().actions.delete(e)},addActionParams(e,t){var o,n;const s=null!==(o=this.getFormModel().actions.get(e))&&void 0!==o?o:new r.FormAction(e),i=null!==(n=s.params)&&void 0!==n?n:new Map;Object.keys(t).forEach(e=>{i.set(e,t[e])}),s.params=i},removeActionParam(e,t){var o;const n=this.getFormModel().actions.get(e);null===(o=null===n||void 0===n?void 0:n.params)||void 0===o||o.delete(t)},getFormModel:()=>n.getInstance().formData,codegenToJson:function(){const e=n.getInstance().formData,t=this.mapToObject(e.data),o={actions:{},data:{}};return o.data=t,e.actions.forEach((e,t)=>{o.actions[t]={},o.actions[t].action=e.action,e.params instanceof Map&&e.params.size>0&&(o.actions[t].params=this.mapToObject(e.params)),e.want instanceof Map&&e.want.size>0&&(o.actions[t].want=this.mapToObject(e.want))}),JSON.stringify(o,null,4)},clear(){n.getInstance().formData.data.clear(),n.getInstance().formData.actions.clear()},mapToObject:e=>void 0===e?{}:Array.from(e.entries()).reduce((e,[t,o])=>Object.assign(Object.assign({},e),{[t]:o}),{}),objectToMap(e){const t=new Map;return Object.keys(e).forEach((o,n)=>{t.set(o,e[o])}),t}}},945:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FormAction=t.FormModel=void 0;t.FormModel=class{constructor(){this.data=new Map,this.actions=new Map}};t.FormAction=class{constructor(e,t,o){this.action=e,this.params=t,this.want=o}}},509:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deserializeForVersion1=t.rootToVisualContent=t.visualToRootContent=t.serializeForVersion1=void 0;const n=o(891),r=o(933),s=o(571),i=o(282),a=o(945),c=o(977),l=new Map;function d(e){l.set("textMap",new Map);const t=function e(t){const o=Array.from(t.property).filter(e=>s.isAttribute(e[0]));o.push(["id",t.id]);const n=Array.from(t.property).filter(e=>s.isStyle(e[0]));let r=i.TagTypeMap.get(t.type);void 0===r&&(r="Base");let a=t.property.has("content")?t.property.get("content"):[];if(t.children.length>0){if("string"==typeof a){const e=l.get("textMap");e instanceof Map&&e.set(t.id,a)}a=t.children.map(t=>e(t))}return{id:t.id,tagName:t.type,attributes:o,idStyle:n,type:r,content:a}}(null!==e&&void 0!==e?e:n.getInstance().visualModel);return JSON.stringify({VisualVersion:"1",content:JSON.stringify(t),extraData:JSON.stringify(function e(t){if(t instanceof Map){const o=["$$map"];for(const[n,r]of t)o.push([n,e(r)]);return o}return t}(l))})}function h(e,t){let o;if(t instanceof Map){const n=t.get("textMap");n instanceof Map&&(o=n.get(e.id))}const n=new r.VisualModel({id:e.id,type:e.tagName,property:new Map([...e.attributes,...e.idStyle])});return"string"==typeof o&&n.property.set("content",o),n.property.delete("id"),"string"==typeof e.content&&n.property.set("content",e.content),Array.isArray(e.content)&&(n.children=e.content.map(e=>h(e,t))),n}function p(e){if(e instanceof Array&&e.length>0&&"$$map"===e[0]){e.shift();const t=new Map;for(const[o,n]of e)t.set(o,p(n));return t}return e}t.serializeForVersion1=d,t.visualToRootContent=function(e){try{return d(JSON.parse(e,c.reviver).visualModel)}catch(e){console.error("convert visual model to root model failed")}return e},t.rootToVisualContent=function(e){const t=JSON.parse(e),o=JSON.parse(t.content);let n='["$$map",["textMap",["$$map"]]]';"string"==typeof t.extraData&&(n=JSON.parse(t.extraData));const r=h(o,p(n));return r.property.has("flex-direction")||r.property.set("flex-direction","column"),JSON.stringify({document:{VisualVersion:"12",type:"FA"},visualModel:r,formData:new a.FormModel},c.replacer)},t.deserializeForVersion1=function(e){try{const t=JSON.parse(e),o=JSON.parse(t.content);let r='["$$map",["textMap",["$$map"]]]';"string"==typeof t.extraData&&(r=JSON.parse(t.extraData)),n.getInstance().visualModel=h(o,p(r)),n.getInstance().visualModel.property.has("flex-direction")||n.getInstance().visualModel.property.set("flex-direction","column")}catch(e){console.error("convert error")}}},891:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setInstance=t.getInstance=void 0;const n=o(933),r=o(945),s={document:{VisualVersion:"12",type:"FA"},visualModel:new n.VisualModel({type:"div",id:"wrapper"}),formData:new r.FormModel};t.getInstance=function(){return s},t.setInstance=function(e){for(const t in s)Object.prototype.hasOwnProperty.call(e,t)&&(s[t]=e[t])}},977:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.reviver=t.replacer=t.deserialize=t.serialize=void 0;const n=o(933),r=o(891),s=o(509);function i(e,t){if(t instanceof Map)return{dataType:"Map",value:Object.fromEntries(t.entries())};if(t instanceof Set)return{dataType:"Set",value:Array.from(t.entries())};if(t instanceof n.VisualModel){const e=new n.VisualModel({type:"none"}),o={};for(const n in e)Object.prototype.hasOwnProperty.call(t,n)&&(o[n]=t[n]);return{dataType:"VisualModel",value:o}}return t}function a(e,t){if("object"==typeof t&&null!==t&&void 0!==t){if("Map"===t.dataType)return new Map(Object.entries(t.value));if("Set"===t.dataType)return new Set(t.value);if("VisualModel"===t.dataType){const e=new n.VisualModel({type:""});Object.assign(e,t.value),t=e}}return t}t.serialize=function(e,t){return 1===e?s.serializeForVersion1(t):JSON.stringify(null!==t&&void 0!==t?t:r.getInstance(),i)},t.deserialize=function(e){if("1"===JSON.parse(e).VisualVersion)return s.deserializeForVersion1(e);const t=JSON.parse(e,a);r.setInstance(t)},t.replacer=i,t.reviver=a},933:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VisualModel=void 0;const o="-visual";t.VisualModel=class{constructor(e){if(this.mediaProperty=void 0,this.property=void 0!==e.property?e.property:new Map,this.children=void 0!==e.children?e.children:[],"wrapper"===e.type)return this.id="wrapper",void(this.type="div");e.type.endsWith(o)&&(e.type=e.type.substring(0,e.type.length-o.length)),this.id=void 0!==e.id?e.id:"",this.type=e.type}accept(e){return e.visit(this)}}}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,o),s.exports}var n={};(()=>{var e=n;Object.defineProperty(e,"__esModule",{value:!0});const t=o(784),r=o(891),s=o(977),i=o(844),a=o(55),c=o(207),l=12;e.genHmlAndCss=function(e){const o={hmlCss:{hml:"",css:"",json:""},errorType:"",errorMessage:""};try{s.deserialize(e);const t=r.getInstance().document.VisualVersion,n=/^([1-9]+[0-9]*)$/;if(void 0===t)o.errorType="versionError";else{const e=t.match(n);(null===e||parseInt(e[1])>l)&&(o.errorType="versionError")}try{const e=function(e){const t={hml:"",css:"",json:""},o=new i.HMLBridge,n=e.accept(o),r=a.genFAHML(n);o.getErrorCount()>0?t.hml="error":t.hml=r;const s=new i.CSSBridge,c=e.accept(s),l=a.genFACSS(c);return s.getErrorCount()>0?t.css="error":t.css=l,t}(r.getInstance().visualModel);"error"!==e.hml&&"error"!==e.css||(o.errorType="codegenError"),o.hmlCss=e,"FORM"===r.getInstance().document.type&&(o.hmlCss.json=c.formManager.codegenToJson())}catch(e){o.errorType="modelError"}}catch(e){o.errorType="fileError"}return""!==o.errorType&&(o.errorMessage=t.errorMap.get(o.errorType),o.hmlCss.hml="",o.hmlCss.css=""),o}})();var r=exports;for(var s in n)r[s]=n[s];n.__esModule&&Object.defineProperty(r,"__esModule",{value:!0})})();