"use strict";var _path=_interopRequireDefault(require("path")),_pre_define=require("./pre_define"),_process_ui_syntax=require("./process_ui_syntax"),_validate_ui_syntax=require("./validate_ui_syntax"),_utils=require("./utils"),_main=require("../main");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _newArrowCheck(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}module.exports=function(e,t){var r,i=this;process.env.compiler=_pre_define.BUILD_OFF,/\.ets$/.test(this.resourcePath)&&(_utils.componentInfo.id=0,_validate_ui_syntax.propertyCollection.clear(),_validate_ui_syntax.linkCollection.clear(),(0,_validate_ui_syntax.resetComponentCollection)(),_process_ui_syntax.transformLog&&_process_ui_syntax.transformLog.errors.length&&(r=_process_ui_syntax.transformLog.sourceFile,n=_process_ui_syntax.transformLog.errors.map(function(e){var t;return _newArrowCheck(this,i),e.pos?(t=r.getLineAndCharacterOfPosition(e.pos),e.line=t.line+1,e.column=t.character+1):(e.line=void 0,e.column=void 0),e.fileName=r.fileName.replace(/.ts$/,""),e}.bind(this)),(0,_utils.emitLogInfo)(this,n),(0,_process_ui_syntax.resetLog)()));var n=_path.default.basename(this.resourcePath);["app.ets",_main.abilityConfig.abilityEntryFile].includes(n)&&(e=e.replace(/exports\.default/,"globalThis.exports.default")),this.callback(null,e,t)};