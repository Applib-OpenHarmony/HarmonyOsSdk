"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LogType=exports.IGNORE_ERROR_CODE=exports.FileLog=void 0,exports.addLog=addLog,exports.circularFile=circularFile,exports.componentInfo=void 0,exports.createFunction=createFunction,exports.emitLogInfo=emitLogInfo,exports.getMessage=getMessage,exports.hasDecorator=hasDecorator,exports.mkDir=mkDir,exports.readFile=readFile,exports.toHashData=toHashData,exports.toUnixPath=toUnixPath;var _typescript=_interopRequireDefault(require("typescript")),_path=_interopRequireDefault(require("path")),_fs=_interopRequireDefault(require("fs")),_crypto=require("crypto");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _newArrowCheck(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let LogType;exports.LogType=LogType,function(e){e.ERROR="ERROR",e.WARN="WARN",e.NOTE="NOTE"}(LogType||(exports.LogType=LogType={}));class FileLog{constructor(){_defineProperty(this,"_sourceFile",void 0),_defineProperty(this,"_errors",[])}get sourceFile(){return this._sourceFile}set sourceFile(e){this._sourceFile=e}get errors(){return this._errors}set errors(e){this._errors=e}}function emitLogInfo(t,e){var r=this;e&&e.length&&e.forEach(function(e){switch(_newArrowCheck(this,r),e.type){case LogType.ERROR:t.emitError(getMessage(t.resourcePath,e));break;case LogType.WARN:case LogType.NOTE:t.emitWarning(getMessage(t.resourcePath,e))}}.bind(this))}function addLog(e,t,r,o,n){r=n.getLineAndCharacterOfPosition(r);o.push({type:e,message:t,line:r.line+1,column:r.character+1,fileName:n.fileName})}function getMessage(e,t){let r;return r=t.line&&t.column?`BUILD${t.type} File: ${e}:${t.line}:${t.column}
 `+t.message:`BUILD${t.type} File: ${e}
 `+t.message,r}exports.FileLog=FileLog;class ComponentInfo{constructor(){_defineProperty(this,"_id",0),_defineProperty(this,"_componentNames",new Set(["ForEach"]))}set id(e){this._id=e}get id(){return this._id}set componentNames(e){this._componentNames=e}get componentNames(){return this._componentNames}}const componentInfo=new ComponentInfo;function hasDecorator(t,r){if(t.decorators&&t.decorators.length)for(let e=0;e<t.decorators.length;e++)if(t.decorators[e].getText().replace(/\(.*\)$/,"").trim()===r)return!0;return!1}exports.componentInfo=componentInfo;const STATEMENT_EXPECT=1128,SEMICOLON_EXPECT=1005,STATESTYLES_EXPECT=1003,IGNORE_ERROR_CODE=[STATEMENT_EXPECT,SEMICOLON_EXPECT,STATESTYLES_EXPECT];function readFile(r,o){var n=this;try{const e=_fs.default.readdirSync(r);e.forEach(function(e){_newArrowCheck(this,n);e=_path.default.join(r,e);const t=_fs.default.statSync(e);t.isDirectory()?readFile(e,o):o.push(e)}.bind(this))}catch(e){console.error("ETS ERROR: "+e)}}function createFunction(e,t,r){return _typescript.default.factory.createCallExpression(_typescript.default.factory.createPropertyAccessExpression(e,t),void 0,r&&r.length?r:[])}function circularFile(n,i){n&&i&&_fs.default.readdir(n,function(e,t){var o=this;t&&t.forEach(function(e){_newArrowCheck(this,o);var t=_path.default.resolve(n,e),e=_path.default.resolve(i,e);const r=_fs.default.statSync(t);(r.isFile()?copyFile:circularFile)(t,e)}.bind(this))})}function copyFile(e,t){try{var r=_path.default.join(t,"..");if(_fs.default.existsSync(r)&&_fs.default.statSync(r).isDirectory()||mkDir(r),_fs.default.existsSync(t))return;const o=_fs.default.createReadStream(e),n=_fs.default.createWriteStream(t);o.pipe(n),o.on("close",function(){n.end()})}catch(e){throw e.message}}function mkDir(e){var t=_path.default.join(e,"..");_fs.default.existsSync(t)&&!_fs.default.statSync(t).isFile()||mkDir(t),_fs.default.mkdirSync(e)}function toUnixPath(e){if(/^win/.test(require("os").platform())){var t=e.split(_path.default.sep);return _path.default.posix.join(...t)}return e}function toHashData(e){e=_fs.default.readFileSync(e);const t=(0,_crypto.createHash)("sha256");return t.update(e),t.digest("hex")}exports.IGNORE_ERROR_CODE=IGNORE_ERROR_CODE;